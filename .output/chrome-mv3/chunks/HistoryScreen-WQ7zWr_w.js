import{c as f,r,j as t}from"./sidepanel-DOESzR4q.js";import{d as p}from"./db-B74-OlEL.js";import{I as D}from"./Input-BaDuoGWj.js";import{C as h,a as g}from"./card-CmhX-YKG.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=f("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=f("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function z(){const[u,m]=r.useState([]),[d,y]=r.useState([]),[i,j]=r.useState(""),[n,N]=r.useState("all"),[o,b]=r.useState(null),[v,x]=r.useState(!1),w=30;r.useEffect(()=>{(async()=>{const a=await p.conversations.orderBy("sentAt").reverse().limit(50).toArray();m(a)})()},[]),r.useEffect(()=>{const e=window.matchMedia("(prefers-reduced-motion: reduce)");x(e.matches);const a=()=>x(e.matches);return e.addEventListener("change",a),()=>e.removeEventListener("change",a)},[]),r.useEffect(()=>{let e=u;if(n!=="all"&&(e=e.filter(a=>a.platform===n)),i){const a=i.toLowerCase();e=e.filter(s=>s.pageName.toLowerCase().includes(a)||s.sentMessage.toLowerCase().includes(a))}y(e)},[u,n,i]);const k=async e=>{confirm("Delete this conversation?")&&(await p.conversations.delete(e),m(a=>a.filter(s=>s.id!==e)))},C=(e=>{const a={};return e.forEach(s=>{const l=new Date(s.sentAt).toLocaleDateString();a[l]||(a[l]=[]),a[l].push(s)}),a})(d),S=e=>{switch(e){case"x":return"ð•";case"linkedin":return"in";case"github":return"GH";default:return"ðŸŒ"}};return t.jsxs("div",{className:"space-y-3",children:[t.jsx(D,{placeholder:"Search conversations...",variant:"bordered",size:"md",leftIcon:t.jsx(E,{size:16}),value:i,onChange:e=>j(e.target.value),"aria-label":"Search conversations"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:["all","x","linkedin","github","generic"].map(e=>t.jsx("button",{onClick:()=>N(e),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${n===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-card"}`,"aria-pressed":n===e,children:e==="all"?"All":e.charAt(0).toUpperCase()+e.slice(1)},e))}),d.length===0?t.jsx(h,{variant:"default",children:t.jsx(g,{className:"p-8 text-center",children:t.jsx("p",{className:"text-[13px] leading-relaxed text-muted-foreground",children:i||n!=="all"?"No conversations match your search":"No conversations yet"})})}):Object.entries(C).map(([e,a])=>t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"text-sm font-semibold leading-tight text-muted-foreground px-1",children:e===new Date().toLocaleDateString()?"Today":e}),a.map(s=>{const l=d.findIndex(c=>c.id===s.id);return t.jsx(h,{variant:"default",className:`cursor-pointer transition-all ${o===s.id?"ring-2 ring-primary":""}`,style:v?{opacity:1}:{animation:`fade-in-up ${l*w}ms forwards`,opacity:0},onClick:()=>b(o===s.id?null:s.id),children:t.jsx(g,{className:"p-3",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-muted flex items-center justify-center text-[10px] leading-normal font-numerical",children:S(s.platform)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsx("h4",{className:"text-sm font-semibold leading-tight text-foreground truncate",children:s.pageName}),t.jsx("span",{className:"text-xs leading-normal text-muted-foreground font-numerical flex-shrink-0",children:new Date(s.sentAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),!o&&t.jsx("p",{className:"text-[13px] leading-relaxed text-muted-foreground truncate mt-1",children:s.sentMessage}),t.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[t.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${s.status==="sent"?"bg-info":s.status==="responded"?"bg-success":"bg-muted-foreground"}`}),t.jsx("span",{className:"text-xs leading-normal text-muted-foreground capitalize",children:s.status.replace("_"," ")})]}),o===s.id&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[t.jsx("p",{className:"text-[13px] leading-relaxed text-foreground whitespace-pre-wrap",children:s.sentMessage}),t.jsxs("div",{className:"flex items-center justify-between mt-3",children:[t.jsxs("span",{className:"text-xs leading-normal text-muted-foreground",children:["Angle: ",s.angle]}),t.jsx("button",{onClick:c=>{c.stopPropagation(),k(s.id)},className:"text-destructive hover:text-destructive/80 transition-colors","aria-label":`Delete conversation with ${s.pageName}`,children:t.jsx(A,{size:14})})]})]})]})]})})},s.id)})]},e))]})}export{z as default};
