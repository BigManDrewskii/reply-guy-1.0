import{c as P,r as m,u as he,d as Ce,j as e,b as de}from"./sidepanel-BVNUtaom.js";import{s as we,e as Se}from"./openrouter-Drn9t11s.js";import{d as Ae,B as $,C as re,a as ae,b as Ee,c as Pe}from"./badge-Db7Lyzlw.js";import{e as Me,s as ze,f as Te,A as fe,T as Ie,a as Le,b as ue,d as me,G as Re,C as Ve}from"./alert-DFdCYBKD.js";import{B as L,L as _}from"./button-BSa-vXH9.js";import{M as ye}from"./mic-DM92m3Dn.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=P("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=P("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=P("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=P("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=P("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=P("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=P("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=P("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=P("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=P("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=P("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),Be=/https?:\/\/[^\s<>"{}|\\^`\[\]]+/gi;function Je(i){const l=i.match(Be)||[];return[...new Set(l)]}function Ye(i){const l=i.trim();return/^https?:\/\/\S+$/.test(l)}function Ge(i){try{const l=new URL(i),c=l.hostname.replace("www.",""),o=l.pathname.split("/").filter(Boolean);if(o.length>0){const v=o[o.length-1].slice(0,30);return`${c}/${v}`}return c}catch{return i.slice(0,40)}}async function We(i){const l=`https://r.jina.ai/${i}`,c=await fetch(l,{headers:{Accept:"text/markdown"}});if(!c.ok)throw new Error(`Failed to fetch content (${c.status})`);const o=await c.text();if(!o||o.trim().length<50)throw new Error("No meaningful content extracted from URL");return o.trim()}async function ve(i,l,c){const o=`You are a writing sample extraction specialist. Your job is to take raw content and extract discrete, individual writing samples from a SINGLE author.

INPUT CONTENT:
---
${i.slice(0,12e3)}
---

TASK:
1. Identify individual writing samples (messages, posts, paragraphs, emails) from the content above
2. Each sample should be a complete thought or message from the same person
3. Remove any metadata, timestamps, usernames, "RT", "Retweeted", navigation text, or UI artifacts
4. Remove any content that is clearly NOT written by the primary author (quotes from others, retweets, etc.)
5. Keep the original wording exactly — do NOT paraphrase or clean up grammar
6. Each sample should be at least 10 words long
7. Aim for 5-30 samples depending on content length

Return a JSON array of strings, each being one writing sample. No markdown, no code blocks, just raw JSON:
["sample 1 text here", "sample 2 text here", ...]

CRITICAL: Return ONLY the JSON array. No explanation, no markdown formatting.`;return new Promise((v,C)=>{let O="";we([{role:"system",content:"You extract writing samples from raw content. Return only a JSON array of strings."},{role:"user",content:o}],l,{onChunk:A=>{O+=A,c&&c(`Segmenting content... (${O.length} chars)`)},onComplete:A=>{try{const p=Se(A),R=JSON.parse(p);if(!Array.isArray(R))throw new Error("Expected JSON array");const z=R.filter(h=>typeof h=="string").map(h=>h.trim()).filter(h=>h.split(/\s+/).length>=10);if(z.length===0)throw new Error("No valid writing samples found in content");v(z)}catch(p){console.error("[content-ingestion] Segmentation parse error:",p,`
Raw:`,A),C(new Error("Failed to segment content into writing samples"))}},onError:A=>{C(A)}})})}function He(i){const l=[/\n---+\n/,/\n\n\n+/,/\n={3,}\n/];for(const o of l){const v=i.split(o).map(C=>C.trim()).filter(C=>C.length>20);if(v.length>=3)return v}const c=i.split(/\n\n+/).map(o=>o.trim()).filter(o=>o.length>20);return c.length>=3?c:i.trim().length>20?[i.trim()]:[]}function je(){return`src_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}function Ke(i){return i>=5?{score:95,label:"Optimal",suggestion:"Diminishing returns from more samples"}:i>=4?{score:90,label:"Excellent"}:i>=3?{score:75,label:"Strong"}:i>=2?{score:50,label:"Good",suggestion:"Add more samples for better matching"}:{score:25,label:"Basic",suggestion:"Add at least 4 more samples for reliable matching"}}function Xe(i,l){return`You are an expert linguist specializing in authorial style analysis and stylometry.

Analyze the following ${i.length} writing samples from the SAME author. Your goal is to create a comprehensive, structured voice profile that would allow someone to perfectly replicate this person's writing style.

${l}

---

WRITING SAMPLES:
${i.map((c,o)=>`--- Sample ${o+1} ---
${c}`).join(`

`)}

---

Perform a 3-step analysis:

STEP 1 — REGISTER ANALYSIS (Biber's 6 dimensions):
Rate the author on each dimension from 1-10:
- involvedVsInformational: 1=personal/emotional, 10=detached/factual
- narrativeVsNonNarrative: 1=story-like, 10=expository
- situationDependentVsExplicit: 1=assumes context, 10=spells everything out
- nonPersuasiveVsPersuasive: 1=neutral/informative, 10=actively persuading
- concreteVsAbstract: 1=specific/tangible, 10=theoretical/conceptual
- casualVsFormalElaboration: 1=casual/simple, 10=formal/elaborate

STEP 2 — VOICE DNA EXTRACTION:
Identify:
- Tone (primary mood, secondary undertone, humor style, confidence level)
- Style descriptors (5-8 adjectives that capture the voice)
- Signature patterns (how they open, transition, close, and any catchphrases)
- Anti-patterns (things this writer NEVER does — be specific)
- Voice rules (5-10 actionable instructions for replicating this voice)

STEP 3 — STRUCTURED OUTPUT:
Return a JSON object with this EXACT schema (no markdown, no code blocks, just raw JSON):
{
  "register": {
    "involvedVsInformational": <1-10>,
    "narrativeVsNonNarrative": <1-10>,
    "situationDependentVsExplicit": <1-10>,
    "nonPersuasiveVsPersuasive": <1-10>,
    "concreteVsAbstract": <1-10>,
    "casualVsFormalElaboration": <1-10>
  },
  "tone": {
    "primary": "<single word>",
    "secondary": "<single word>",
    "humor": "<none|dry|sarcastic|self-deprecating|playful|witty>",
    "confidence": "<tentative|balanced|assertive|commanding>"
  },
  "descriptors": ["<5-8 style adjectives>"],
  "signatures": {
    "openingPatterns": ["<3-5 patterns, e.g. 'Starts with a direct observation'>"],
    "transitionWords": ["<5-8 favorite connectors>"],
    "closingPatterns": ["<3-5 patterns, e.g. 'Ends with a question'>"],
    "catchphrases": ["<2-5 recurring expressions or idioms>"]
  },
  "antiPatterns": ["<5-8 things this writer NEVER does>"],
  "rules": ["<5-10 actionable voice replication rules>"]
}

CRITICAL RULES:
- Base your analysis on ACTUAL EVIDENCE from the samples, not assumptions
- Anti-patterns are as important as positive patterns — be specific
- Rules must be actionable ("Use contractions freely" not "Is casual")
- Cross-reference your analysis with the quantitative metrics provided
- If the metrics show high contraction rate, the rules MUST mention contractions
- If the metrics show short sentences, the rules MUST mention sentence length`}function _e(){const[i,l]=m.useState(1),[c,o]=m.useState([]),[v,C]=m.useState([]),[O,A]=m.useState(!1),[p,R]=m.useState(""),[z,h]=m.useState(null),[D,s]=m.useState(null),[f,W]=m.useState(null),[H,T]=m.useState(!1),[Z,y]=m.useState("idle"),[ne,S]=m.useState(""),[ee,b]=m.useState(null),I=he(u=>u.apiKey),M=m.useRef(!1),K=v.length,F=m.useCallback(u=>{const d=u.trim();if(!d)return;const r={id:je(),type:"text",label:`Pasted text (${d.split(/\s+/).length} words)`,rawContent:d,status:"ready"};o(x=>[...x,r]),b(null)},[]),q=m.useCallback(async u=>{const d=je(),r={id:d,type:"url",label:Ge(u),rawContent:"",status:"fetching"};o(x=>[...x,r]),b(null);try{const x=await We(u);o(g=>g.map(j=>j.id===d?{...j,rawContent:x,status:"ready"}:j))}catch(x){const g=x instanceof Error?x.message:"Failed to fetch URL";o(j=>j.map(V=>V.id===d?{...V,status:"error",error:g}:V))}},[]),te=m.useCallback(u=>{o(d=>d.filter(r=>r.id!==u)),C(d=>d.filter(r=>r.sourceId!==u))},[]),X=m.useCallback(async u=>{const d=u.trim();if(!d)return;if(Ye(d)){await q(d);return}const r=Je(d);if(r.length>0){for(const g of r)await q(g);let x=d;for(const g of r)x=x.replace(g,"").trim();x.split(/\s+/).length>=10&&F(x);return}F(d)},[q,F]),se=m.useCallback(async()=>{if(!I){b("No API key configured");return}const u=c.filter(r=>r.status==="ready"&&r.rawContent.length>0);if(u.length===0){b("No content to analyze. Add some writing samples first.");return}A(!0),b(null),y("segmenting"),S("Extracting writing samples from your content...");const d=[];for(const r of u)try{let x;if(r.type==="url")S(`AI segmenting content from ${r.label}...`),x=await ve(r.rawContent,I,g=>S(g));else if(x=He(r.rawContent),x.length<3&&r.rawContent.split(/\s+/).length>100){S("AI segmenting pasted text...");try{x=await ve(r.rawContent,I,g=>S(g))}catch{}}for(const g of x)d.push({text:g,sourceId:r.id,sourceLabel:r.label,wordCount:g.split(/\s+/).length})}catch(x){console.warn(`[useVoiceTraining] Failed to segment source ${r.id}:`,x),r.rawContent.split(/\s+/).length>=10&&d.push({text:r.rawContent,sourceId:r.id,sourceLabel:r.label,wordCount:r.rawContent.split(/\s+/).length})}C(d),A(!1),y("idle"),S(""),d.length<3&&b(`Only ${d.length} sample(s) found. Need at least 3 for voice analysis. Try adding more content.`)},[I,c]),ie=m.useCallback(async()=>{if(M.current)return;if(!I){b("No API key configured");return}if(v.length<3){b("Please provide at least 3 writing samples (5+ recommended)");return}M.current=!0,T(!0),b(null),s(null),W(null),h(null);const u=v.map(r=>r.text);y("local-nlp"),S("Extracting quantitative style metrics...");let d;try{d=Me(u),s(d),W(ze(d))}catch(r){console.warn("[useVoiceTraining] Local NLP analysis failed:",r),b("Failed to analyze writing samples locally"),T(!1),y("idle"),M.current=!1;return}y("llm-analysis"),S("Running AI voice analysis (register dimensions, tone, patterns)...");try{const r=Te(d),x=Xe(u,r);let g="";await we([{role:"system",content:"You are an expert linguist and stylometry analyst. You produce precise, structured JSON analyses of writing styles. Never include markdown formatting in your output."},{role:"user",content:x}],I,{onChunk:j=>{g+=j,S(`Analyzing voice patterns... (${g.length} chars received)`)},onComplete:j=>{var V,B,J,U;try{y("building-profile"),S("Building structured voice profile...");const a=Se(j),t=JSON.parse(a);if(!t.register||!t.tone||!t.rules)throw new Error("Missing required fields in LLM response");const N=u.slice(0,5).map(k=>({text:k,context:"outreach message",wordCount:k.split(/\s+/).length})),w=Ke(u.length),n={id:"default",createdAt:Date.now(),updatedAt:Date.now(),sampleCount:u.length,register:{involvedVsInformational:Y(t.register.involvedVsInformational,1,10),narrativeVsNonNarrative:Y(t.register.narrativeVsNonNarrative,1,10),situationDependentVsExplicit:Y(t.register.situationDependentVsExplicit,1,10),nonPersuasiveVsPersuasive:Y(t.register.nonPersuasiveVsPersuasive,1,10),concreteVsAbstract:Y(t.register.concreteVsAbstract,1,10),casualVsFormalElaboration:Y(t.register.casualVsFormalElaboration,1,10)},tone:{primary:t.tone.primary||"direct",secondary:t.tone.secondary||"warm",humor:t.tone.humor||"none",confidence:t.tone.confidence||"balanced"},descriptors:Array.isArray(t.descriptors)?t.descriptors.slice(0,8):[],signatures:{openingPatterns:((V=t.signatures)==null?void 0:V.openingPatterns)||[],transitionWords:((B=t.signatures)==null?void 0:B.transitionWords)||[],closingPatterns:((J=t.signatures)==null?void 0:J.closingPatterns)||[],catchphrases:((U=t.signatures)==null?void 0:U.catchphrases)||[]},antiPatterns:Array.isArray(t.antiPatterns)?t.antiPatterns.slice(0,8):[],rules:Array.isArray(t.rules)?t.rules.slice(0,10):[],metrics:d,exemplars:N,quality:w};h(n),y("complete"),S("Voice profile complete!"),T(!1),M.current=!1,l(3)}catch(a){console.error("[useVoiceTraining] Parse error:",a,`
Raw:`,j),b("Failed to parse voice analysis. Please try again."),T(!1),y("idle"),M.current=!1}},onError:j=>{console.error("[useVoiceTraining] LLM error:",j),b(j.message),T(!1),y("idle"),M.current=!1}})}catch(r){b(r instanceof Error?r.message:"Voice analysis failed"),T(!1),y("idle"),M.current=!1}},[I,v]),le=m.useCallback(async()=>{if(!z)return!1;try{const u=JSON.parse(JSON.stringify(z));return await Ae.voiceProfiles.put(u),await new Promise((d,r)=>{chrome.storage.local.set({voiceProfile:u},()=>{chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):d()})}),he.getState().setVoiceProfileLoaded(!0),!0}catch(u){return console.error("[useVoiceTraining] Save failed:",u),b(`Failed to save voice profile: ${u instanceof Error?u.message:"Unknown error"}`),!1}},[z]),oe=m.useCallback(()=>{l(1),o([]),C([]),R(""),h(null),s(null),W(null),y("idle"),S(""),b(null),A(!1),M.current=!1},[]);return{step:i,setStep:l,sources:c,addTextSource:F,addUrlSource:q,removeSource:te,autoDetectAndAdd:X,writingSamples:v,isSegmenting:O,segmentSources:se,rawTextInput:p,setRawTextInput:R,sampleCount:K,voiceProfile:z,localMetrics:D,localMetricsSummary:f,isExtracting:H,extractionStage:Z,extractionProgress:ne,error:ee,analyzeVoice:ie,saveVoiceProfile:le,reset:oe}}function Y(i,l,c){return Math.max(l,Math.min(c,Number(i)||l))}function at({onBack:i}){const{step:l,setStep:c,sources:o,addTextSource:v,addUrlSource:C,removeSource:O,autoDetectAndAdd:A,writingSamples:p,isSegmenting:R,segmentSources:z,rawTextInput:h,setRawTextInput:D,voiceProfile:s,localMetrics:f,localMetricsSummary:W,isExtracting:H,extractionStage:T,extractionProgress:Z,error:y,analyzeVoice:ne,saveVoiceProfile:S,reset:ee}=_e(),{add:b}=Ce(),[I,M]=m.useState(!1),[K,F]=m.useState(""),[q,te]=m.useState(!1),[X,se]=m.useState(!1),[ie,le]=m.useState({register:!0,metrics:!1,patterns:!1,rules:!1,exemplars:!1});m.useEffect(()=>{chrome.storage.local.get("voiceProfile",a=>{a.voiceProfile&&M(!0)})},[]);const oe=a=>{le(t=>({...t,[a]:!t[a]}))},u=async()=>{se(!0);const a=await S();se(!1),a&&(b({type:"success",message:"Voice profile saved successfully"}),i&&i())},d=()=>{i&&(ee(),i())},r=async()=>{const a=K.trim();a&&(te(!0),await C(a),F(""),te(!1))},x=()=>{h.trim()&&(v(h),D(""))},g=async()=>{h.trim()&&(await A(h),D(""))},j=async()=>{await z()},V=()=>{c(2)};m.useEffect(()=>{l===2&&!H&&!s&&!y&&p.length>=3&&ne()},[l]),m.useEffect(()=>{l===2&&s&&!H&&c(3)},[l,s,H,c]);const B=({current:a})=>{const t=[{num:1,label:"Add Content"},{num:2,label:"Analyze"},{num:3,label:"Review"}];return e.jsx("div",{className:"flex items-center gap-1.5 mb-5",children:t.map((N,w)=>e.jsxs("div",{className:"flex items-center gap-1.5 flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center gap-0.5 flex-shrink-0",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-semibold transition-all duration-300 ${N.num<a?"bg-primary text-primary-foreground":N.num===a?"bg-primary text-primary-foreground ring-2 ring-primary/30 ring-offset-1 ring-offset-background":"bg-muted text-muted-foreground"}`,children:N.num<a?e.jsx(de,{size:10}):N.num}),e.jsx("span",{className:"text-[9px] text-muted-foreground",children:N.label})]}),w<t.length-1&&e.jsx("div",{className:`flex-1 h-0.5 rounded-full transition-colors duration-300 mb-3 ${N.num<a?"bg-primary":"bg-muted"}`})]},N.num))})},J=()=>e.jsxs("div",{className:"flex items-center gap-2.5 mb-1",children:[e.jsx("button",{onClick:d,className:"text-muted-foreground hover:text-foreground transition-colors p-1 -ml-1 rounded-md","aria-label":"Back to settings",children:e.jsx(Ue,{size:16})}),e.jsx(Q,{size:16,className:"text-primary"}),e.jsx("h2",{className:"text-sm font-semibold text-foreground",children:"Voice Training"})]}),U=({id:a,title:t,icon:N,children:w,badge:n})=>{const k=ie[a]??!1;return e.jsxs(re,{variant:"default",children:[e.jsxs("button",{onClick:()=>oe(a),className:"w-full flex items-center justify-between px-3.5 py-2.5 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{size:13,className:"text-muted-foreground"}),e.jsx("span",{className:"text-xs font-semibold text-foreground",children:t}),n&&e.jsx($,{variant:"outline",size:"sm",children:n})]}),k?e.jsx($e,{size:13,className:"text-muted-foreground"}):e.jsx(Ve,{size:13,className:"text-muted-foreground"})]}),k&&e.jsx(ae,{className:"pt-0 pb-3 px-3.5 border-t border-border/30",children:w})]})};if(l===1){const a=o.filter(n=>n.status==="ready"),t=o.filter(n=>n.status==="fetching"),N=a.length>0,w=p.length>=3;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(J,{}),e.jsx(B,{current:1}),I&&e.jsx(fe,{variant:"warning",children:"You have an existing voice profile. Training will replace it."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] text-foreground font-medium mb-1",children:"Feed your writing to the AI"}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Paste text, drop in URLs to your posts/articles, or paste entire documents. The AI will extract and segment your writing samples automatically."})]}),e.jsxs(Ie,{defaultValue:"smart",children:[e.jsxs(Le,{children:[e.jsx(ue,{value:"smart",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ge,{size:11}),"Smart Paste"]})}),e.jsx(ue,{value:"url",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(qe,{size:11}),"Add URL"]})}),e.jsx(ue,{value:"text",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(De,{size:11}),"Paste Text"]})})]}),e.jsxs(me,{value:"smart",className:"mt-3 space-y-2.5",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:"Paste anything — URLs, documents, emails, tweets, blog posts. The AI auto-detects the format and extracts writing samples."}),e.jsx("textarea",{value:h,onChange:n=>D(n.target.value),placeholder:`Paste anything here:

• A URL to your blog post or tweet
• An email you wrote
• A document or essay
• Multiple messages (any format)

The AI will figure out the rest...`,className:"w-full h-40 px-3 py-2.5 bg-background border border-border/60 rounded-lg text-[13px] leading-relaxed text-foreground placeholder-muted-foreground/40 focus:outline-none focus:ring-2 focus:ring-ring/40 focus:border-ring resize-none font-mono transition-colors"}),e.jsxs(L,{onClick:g,disabled:!h.trim(),variant:"primary",size:"sm",className:"w-full",children:[e.jsx(be,{size:13,className:"mr-1.5"}),"Add to Sources"]})]}),e.jsxs(me,{value:"url",className:"mt-3 space-y-2.5",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:"Add URLs to your tweets, blog posts, LinkedIn posts, or any page with your writing. Content is extracted using Jina Reader AI."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:K,onChange:n=>F(n.target.value),onKeyDown:n=>n.key==="Enter"&&r(),placeholder:"https://x.com/you/status/...",className:"flex-1 px-3 py-2 bg-background border border-border/60 rounded-lg text-[13px] text-foreground placeholder-muted-foreground/40 focus:outline-none focus:ring-2 focus:ring-ring/40 focus:border-ring transition-colors"}),e.jsx(L,{onClick:r,disabled:!K.trim()||q,variant:"primary",size:"sm",children:q?e.jsx(_,{size:13,className:"animate-spin"}):e.jsx(be,{size:13})})]})]}),e.jsxs(me,{value:"text",className:"mt-3 space-y-2.5",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:"Paste raw text — emails, DMs, documents, essays. The AI will segment it into individual writing samples for analysis."}),e.jsx("textarea",{value:h,onChange:n=>D(n.target.value),placeholder:`Paste your writing here...

You can paste:
• A single long document
• Multiple messages/emails
• Copy-pasted social media posts

No special formatting needed.`,className:"w-full h-40 px-3 py-2.5 bg-background border border-border/60 rounded-lg text-[13px] leading-relaxed text-foreground placeholder-muted-foreground/40 focus:outline-none focus:ring-2 focus:ring-ring/40 focus:border-ring resize-none font-mono transition-colors"}),e.jsxs(L,{onClick:x,disabled:!h.trim(),variant:"primary",size:"sm",className:"w-full",children:[e.jsx(pe,{size:13,className:"mr-1.5"}),"Add Text Source"]})]})]}),o.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-[11px] font-semibold text-foreground",children:["Sources (",o.length,")"]}),t.length>0&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(_,{size:10,className:"animate-spin text-primary"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["Fetching ",t.length,"..."]})]})]}),e.jsx("div",{className:"space-y-1.5",children:o.map(n=>e.jsxs("div",{className:`flex items-center gap-2.5 px-3 py-2 rounded-lg border transition-colors ${n.status==="error"?"border-destructive/30 bg-destructive/5":n.status==="fetching"?"border-primary/30 bg-primary/5":"border-border/40 bg-card"}`,children:[e.jsx("div",{className:`flex-shrink-0 ${n.status==="error"?"text-destructive":n.status==="fetching"?"text-primary":"text-muted-foreground"}`,children:n.type==="url"?n.status==="fetching"?e.jsx(_,{size:13,className:"animate-spin"}):e.jsx(Re,{size:13}):e.jsx(pe,{size:13})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[11px] text-foreground truncate font-medium",children:n.label}),n.status==="ready"&&e.jsxs("p",{className:"text-[9px] text-muted-foreground",children:[n.rawContent.split(/\s+/).length," words extracted"]}),n.status==="error"&&e.jsx("p",{className:"text-[9px] text-destructive",children:n.error}),n.status==="fetching"&&e.jsx("p",{className:"text-[9px] text-primary",children:"Fetching content..."})]}),e.jsx($,{variant:n.status==="error"?"destructive":n.status==="fetching"?"info":"outline",size:"sm",children:n.status==="ready"?"Ready":n.status==="fetching"?"Loading":"Error"}),e.jsx("button",{onClick:()=>O(n.id),className:"text-muted-foreground hover:text-destructive transition-colors p-0.5","aria-label":"Remove source",children:e.jsx(Fe,{size:13})})]},n.id))})]}),p.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-[11px] font-semibold text-foreground",children:["Writing Samples (",p.length,")"]}),e.jsx("span",{className:`text-[10px] font-medium ${p.length>=10?"text-green-500":p.length>=5?"text-primary":p.length>=3?"text-yellow-500":"text-muted-foreground"}`,children:p.length>=10?"Excellent":p.length>=5?"Good":p.length>=3?"Minimum":"Need more"})]}),e.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-1.5 scrollbar-thin",children:[p.slice(0,10).map((n,k)=>e.jsxs("div",{className:"bg-muted/50 rounded-md px-2.5 py-2 border border-border/20",children:[e.jsx("p",{className:"text-[11px] text-foreground leading-relaxed line-clamp-2 font-mono",children:n.text}),e.jsxs("p",{className:"text-[9px] text-muted-foreground mt-1 tabular-nums",children:[n.wordCount," words · from ",n.sourceLabel]})]},k)),p.length>10&&e.jsxs("p",{className:"text-[10px] text-muted-foreground text-center py-1",children:["+",p.length-10," more samples"]})]})]}),(o.length>0||p.length>0)&&e.jsx("div",{className:"flex gap-0.5",children:Array.from({length:5}).map((n,k)=>e.jsx("div",{className:`flex-1 h-1 rounded-full transition-colors duration-300 ${k<Math.min(5,Math.ceil((p.length>0?p.length:a.length)/3))?"bg-primary":"bg-muted"}`},k))}),y&&e.jsx("p",{className:"text-[11px] text-destructive",children:y}),e.jsxs("div",{className:"space-y-2",children:[N&&!w&&!R&&e.jsxs(L,{onClick:j,disabled:t.length>0,variant:"primary",size:"md",className:"w-full",children:[e.jsx(xe,{size:14,className:"mr-1.5"}),"Extract Writing Samples",t.length>0&&" (waiting for URLs...)"]}),R&&e.jsxs(L,{disabled:!0,variant:"primary",size:"md",className:"w-full",children:[e.jsx(_,{size:14,className:"mr-1.5 animate-spin"}),Z||"Segmenting..."]}),w&&e.jsxs(L,{onClick:V,variant:"primary",size:"md",className:"w-full",children:[e.jsx(Q,{size:14,className:"mr-1.5"}),"Analyze My Voice (",p.length," samples)"]})]}),e.jsx("p",{className:"text-[10px] text-muted-foreground/60 text-center leading-relaxed",children:"URLs are fetched via Jina Reader AI. Your text is analyzed locally first, then sent to AI for deep style extraction. Nothing is stored externally."})]})}if(l===2){const a=[{key:"segmenting",label:"Content Segmentation",description:"Extracting discrete writing samples",icon:pe},{key:"local-nlp",label:"Local NLP Analysis",description:"Extracting quantitative style metrics",icon:xe},{key:"llm-analysis",label:"AI Voice Extraction",description:"Register dimensions, tone, patterns",icon:ge},{key:"building-profile",label:"Building Profile",description:"Assembling structured voice fingerprint",icon:Q}],t=["idle","segmenting","local-nlp","llm-analysis","building-profile","complete"],N=t.indexOf(T);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(J,{}),e.jsx(B,{current:2}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] text-foreground font-medium mb-1",children:"Analyzing your voice"}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:Z||"Starting analysis pipeline..."})]}),e.jsx(re,{variant:"default",children:e.jsx(ae,{className:"py-3 space-y-3",children:a.map(w=>{const n=t.indexOf(w.key),k=T===w.key,ce=N>n,ke=w.icon;return e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-500 ${ce?"bg-green-500/15 text-green-500":k?"bg-primary/15 text-primary animate-pulse":"bg-muted text-muted-foreground"}`,children:ce?e.jsx(de,{size:12}):e.jsx(ke,{size:12})}),e.jsxs("div",{className:"flex-1 min-w-0 pt-0.5",children:[e.jsx("p",{className:`text-xs font-medium transition-colors duration-300 ${ce||k?"text-foreground":"text-muted-foreground"}`,children:w.label}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-0.5",children:w.description})]})]},w.key)})})}),f&&e.jsxs(re,{variant:"default",children:[e.jsx(Ee,{children:e.jsx(Pe,{children:"Quick Metrics"})}),e.jsxs(ae,{className:"space-y-2.5",children:[e.jsx("p",{className:"text-[11px] text-muted-foreground leading-relaxed",children:W}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(E,{label:"Readability",value:f.fleschReadingEase,max:100}),e.jsx(E,{label:"Formality",value:f.formalityScore,max:100}),e.jsx(E,{label:"Avg sentence",value:f.sentenceLength.mean,suffix:" words"}),e.jsx(E,{label:"Vocab richness",value:Math.round(f.vocabularyRichness*100),suffix:"%"})]})]})]}),y&&e.jsx(fe,{variant:"error",action:{label:"Go back",onClick:()=>c(1)},children:y}),e.jsx(L,{onClick:()=>{ee(),c(1)},variant:"ghost",size:"sm",className:"w-full",children:"Cancel"})]})}return l===3&&s?e.jsxs("div",{className:"space-y-3",children:[e.jsx(J,{}),e.jsx(B,{current:3}),e.jsxs("div",{className:"flex items-center justify-between bg-card border border-border/40 rounded-lg px-3.5 py-2.5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] font-medium text-foreground",children:"Voice Fingerprint"}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-0.5",children:[s.sampleCount," samples analyzed"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-bold tabular-nums ${s.quality.score>=90?"text-green-500":s.quality.score>=70?"text-primary":"text-yellow-500"}`,children:[s.quality.score,"%"]}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:s.quality.label})]})]}),e.jsx(re,{variant:"default",children:e.jsxs(ae,{className:"py-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ye,{size:12,className:"text-muted-foreground"}),e.jsx("span",{className:"text-xs font-semibold text-foreground",children:"Voice Identity"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{variant:"info",size:"sm",children:s.tone.primary}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"+"}),e.jsx($,{variant:"outline",size:"sm",children:s.tone.secondary}),s.tone.humor!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"·"}),e.jsxs($,{variant:"outline",size:"sm",children:[s.tone.humor," humor"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.descriptors.map((a,t)=>e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-muted text-muted-foreground",children:a},t))}),e.jsxs("div",{className:"pt-2 border-t border-border/30",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground mb-1",children:"Confidence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${s.tone.confidence==="commanding"?"bg-primary w-full":s.tone.confidence==="assertive"?"bg-primary w-3/4":s.tone.confidence==="balanced"?"bg-primary/70 w-1/2":"bg-primary/50 w-1/4"}`})}),e.jsx("span",{className:"text-[10px] text-foreground font-medium capitalize",children:s.tone.confidence})]})]})]})}),e.jsx(U,{id:"register",title:"Register Dimensions",icon:xe,badge:"Biber's 6D",children:e.jsxs("div",{className:"space-y-2.5 mt-2",children:[e.jsx(G,{label:"Involved / Informational",value:s.register.involvedVsInformational,leftLabel:"Personal",rightLabel:"Factual"}),e.jsx(G,{label:"Narrative / Non-narrative",value:s.register.narrativeVsNonNarrative,leftLabel:"Story-like",rightLabel:"Expository"}),e.jsx(G,{label:"Situation / Explicit",value:s.register.situationDependentVsExplicit,leftLabel:"Contextual",rightLabel:"Explicit"}),e.jsx(G,{label:"Neutral / Persuasive",value:s.register.nonPersuasiveVsPersuasive,leftLabel:"Neutral",rightLabel:"Persuasive"}),e.jsx(G,{label:"Concrete / Abstract",value:s.register.concreteVsAbstract,leftLabel:"Concrete",rightLabel:"Abstract"}),e.jsx(G,{label:"Casual / Formal",value:s.register.casualVsFormalElaboration,leftLabel:"Casual",rightLabel:"Formal"})]})}),f&&e.jsxs(U,{id:"metrics",title:"Style Metrics",icon:Q,badge:`${s.sampleCount} samples`,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2.5 mt-2",children:[e.jsx(E,{label:"Readability",value:f.fleschReadingEase,max:100}),e.jsx(E,{label:"Formality",value:f.formalityScore,max:100}),e.jsx(E,{label:"Avg sentence",value:f.sentenceLength.mean,suffix:" words"}),e.jsx(E,{label:"Vocab richness",value:Math.round(f.vocabularyRichness*100),suffix:"%"}),e.jsx(E,{label:"Questions",value:Math.round(f.punctuation.questionRate),suffix:"%"}),e.jsx(E,{label:"Contractions",value:Math.round(f.contractionRate),suffix:"%"}),e.jsx(E,{label:"Active voice",value:Math.round(f.activeVoiceRate),suffix:"%"}),e.jsx(E,{label:"Exclamations",value:Math.round(f.punctuation.exclamationRate),suffix:"%"})]}),f.topBigrams.length>0&&e.jsxs("div",{className:"mt-3 pt-2.5 border-t border-border/30",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-muted-foreground mb-1.5",children:"Signature phrases"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:f.topBigrams.slice(0,8).map((a,t)=>e.jsx($,{variant:"outline",size:"sm",children:a},t))})]})]}),e.jsx(U,{id:"patterns",title:"Signature Patterns",icon:ge,children:e.jsxs("div",{className:"space-y-3 mt-2",children:[s.signatures.openingPatterns.length>0&&e.jsx(Ne,{label:"Opening Patterns",items:s.signatures.openingPatterns}),s.signatures.closingPatterns.length>0&&e.jsx(Ne,{label:"Closing Patterns",items:s.signatures.closingPatterns}),s.signatures.transitionWords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-muted-foreground mb-1.5",children:"Transition Words"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.signatures.transitionWords.map((a,t)=>e.jsx($,{variant:"outline",size:"sm",children:a},t))})]}),s.signatures.catchphrases.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-muted-foreground mb-1.5",children:"Catchphrases"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.signatures.catchphrases.map((a,t)=>e.jsxs($,{variant:"info",size:"sm",children:["“",a,"”"]},t))})]})]})}),e.jsx(U,{id:"rules",title:"Voice Rules",icon:Oe,badge:`${s.rules.length} rules`,children:e.jsxs("div",{className:"space-y-3 mt-2",children:[s.rules.length>0&&e.jsx("div",{className:"space-y-1.5",children:s.rules.map((a,t)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{size:10,className:"text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-[11px] text-foreground/80 leading-relaxed",children:a})]},t))}),s.antiPatterns.length>0&&e.jsxs("div",{className:"pt-2.5 border-t border-border/30",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-destructive/70 mb-1.5",children:"Never Do"}),e.jsx("div",{className:"space-y-1.5",children:s.antiPatterns.map((a,t)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-destructive text-[10px] mt-0.5 flex-shrink-0",children:"×"}),e.jsx("p",{className:"text-[11px] text-muted-foreground leading-relaxed",children:a})]},t))})]})]})}),e.jsx(U,{id:"exemplars",title:"Stored Exemplars",icon:ye,badge:`${s.exemplars.length} samples`,children:e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:"These actual writing samples are injected into every generation prompt for better style matching."}),s.exemplars.map((a,t)=>e.jsxs("div",{className:"bg-muted/50 rounded-md px-2.5 py-2 border border-border/20",children:[e.jsx("p",{className:"text-[11px] text-foreground leading-relaxed line-clamp-3 font-mono",children:a.text}),e.jsxs("p",{className:"text-[9px] text-muted-foreground mt-1 tabular-nums",children:[a.wordCount," words · ",a.context]})]},t))]})}),e.jsxs("div",{className:"flex gap-2 pt-1",children:[e.jsx(L,{onClick:()=>c(1),variant:"ghost",size:"sm",className:"flex-1",children:"Redo"}),e.jsxs(L,{onClick:u,disabled:X,variant:"primary",size:"sm",className:"flex-1",children:[X?e.jsx(_,{size:13,className:"mr-1.5 animate-spin"}):e.jsx(Q,{size:13,className:"mr-1.5"}),X?"Saving...":"Save Profile"]})]}),s.quality.suggestion&&e.jsx("p",{className:"text-[10px] text-muted-foreground/60 text-center",children:s.quality.suggestion})]}):null}function E({label:i,value:l,max:c,suffix:o}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:i}),e.jsxs("span",{className:"text-[11px] font-medium tabular-nums text-foreground",children:[Math.round(l),o||""]})]}),c&&e.jsx("div",{className:"h-1 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary/60 rounded-full transition-all duration-500",style:{width:`${Math.min(100,l/c*100)}%`}})})]})}function G({label:i,value:l,leftLabel:c,rightLabel:o}){const v=(l-1)/9*100;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:c}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:o})]}),e.jsx("div",{className:"relative h-1.5 bg-muted rounded-full",children:e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 rounded-full bg-primary border-2 border-background shadow-sm transition-all duration-500",style:{left:`calc(${v}% - 5px)`}})}),e.jsxs("p",{className:"text-[9px] text-muted-foreground/60 text-center tabular-nums",children:[l,"/10"]})]})}function Ne({label:i,items:l}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-muted-foreground mb-1.5",children:i}),e.jsx("div",{className:"space-y-1",children:l.map((c,o)=>e.jsx("p",{className:"text-[11px] text-foreground/80 leading-relaxed pl-2 border-l-2 border-border/40",children:c},o))})]})}export{at as default};
